% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/lwo.R
\name{predict.lwo}
\alias{predict.lwo}
\title{Predict Method for \code{lwo} Objects}
\usage{
\method{predict}{lwo}(
  object,
  newdata = NULL,
  id.var,
  visit.var,
  time.vars = NULL,
  type = c("link", "response"),
  conf.int = FALSE,
  alpha = 0.05,
  na.action = na.pass
)
}
\arguments{
\item{object}{A fitted \code{lwo} model object.}

\item{newdata}{Data frame of subject-level data at the visits for which predictions
are desired. Must include all covariates appearing in the fitted model formula.}

\item{id.var}{Character string giving the subject identifier variable in \code{newdata}.}

\item{visit.var}{Character string giving the visit/time variable in \code{newdata}.}

\item{time.vars}{Optional character vector of time-varying covariate names. Defaults to \code{NULL}.}

\item{type}{Character string specifying the scale of prediction:
\describe{
  \item{\code{"link"}}{Return predictions on the linear predictor scale (default).}
  \item{\code{"response"}}{Return predictions on the response scale (win probability).}
}}

\item{conf.int}{Logical; if \code{TRUE}, return Wald confidence intervals. Default is \code{FALSE}.}

\item{alpha}{Significance level for confidence intervals. Default is \code{0.05}.}

\item{na.action}{Function indicating how to handle missing values. Default is \code{na.pass}.}
}
\value{
If \code{conf.int = FALSE}, returns a numeric vector of predicted values.
If \code{conf.int = TRUE}, returns a matrix with columns:
\code{"lower.CI"}, \code{"estimate"}, and \code{"upper.CI"}.
}
\description{
Computes predicted linear predictors or response-scale win-probability estimates
from a fitted \code{lwo} model. Optionally returns confidence intervals.
}
\details{
The \code{predict.lwo()} method takes subject-level \code{newdata} and converts it
into pseudo-pair observations using the same pair construction used during model
fitting. Predictions are made on the resulting pair-level design matrix using the
estimated regression coefficients from the fitted model.

If \code{type = "link"} (default), predictions are returned on the linear predictor
scale. If \code{type = "response"}, predictions are mapped through the inverse logit
and returned as estimated conditional win probabilities.

If \code{conf.int = TRUE}, point estimates and corresponding Wald confidence intervals
are returned. Confidence intervals are computed using the estimated variance-covariance
matrix of the regression coefficients stored in the fitted model object.
}
\examples{
data("dat_SID")
dat_SID_long <- dat_SID$long_format
mod.lwo.spline <- lwo(
  GBS_DS ~ treat_ITT + age + pre_diarrhea + GBS_DS_baseline+
   treat_ITT:splines::ns(week,knots = 2),
 data = dat_SID_long,
 id.var = "patient_ID",
 visit.var = "week",
 time.vars = "week",
 corstr = "ar1",
 larger = FALSE
)
newdata <- dat_SID_long |>
dplyr::filter(patient_ID \%in\% c(1,4))
predict(object = mod.lwo.spline,
           newdata = newdata,
           id.var = "patient_ID",
           visit.var = "week",
           time.vars = "week",
           type = "response",
           conf.int = TRUE)

}
